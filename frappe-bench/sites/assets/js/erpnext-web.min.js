!function(){"use strict";window.erpnext||(window.erpnext={}),frappe.send_message=function(t,e){return frappe.call({type:"POST",method:"erpnext.templates.utils.send_message",btn:e,args:t,callback:t.callback})},erpnext.subscribe_to_newsletter=function(t,e){return frappe.call({type:"POST",method:"frappe.email.doctype.newsletter.newsletter.subscribe",btn:e,args:{email:t.email},callback:t.callback})},erpnext.send_message=frappe.send_message,frappe.provide("erpnext.shopping_cart");var t=erpnext.shopping_cart;frappe.ready(function(){var e=frappe.session&&frappe.session.user_fullname;e&&$('.navbar li[data-label="User"] a').html('<i class="fa fa-fixed-width fa fa-user"></i> '+e),t.show_shoppingcart_dropdown(),t.set_cart_count(),t.bind_dropdown_cart_buttons()}),$.extend(t,{show_shoppingcart_dropdown:function(){$(".shopping-cart").on("shown.bs.dropdown",function(){if(!$(".shopping-cart-menu .cart-container").length)return frappe.call({method:"erpnext.shopping_cart.cart.get_shopping_cart_menu",callback:function(t){t.message&&$(".shopping-cart-menu").html(t.message)}})})},update_cart:function(e){if("Guest"!==frappe.session.user)return frappe.call({type:"POST",method:"erpnext.shopping_cart.cart.update_cart",args:{item_code:e.item_code,qty:e.qty,additional_notes:void 0!==e.additional_notes?e.additional_notes:void 0,with_items:e.with_items||0},btn:e.btn,callback:function(a){t.set_cart_count(),a.message.shopping_cart_menu&&$(".shopping-cart-menu").html(a.message.shopping_cart_menu),e.callback&&e.callback(a)}});localStorage&&localStorage.setItem("last_visited",window.location.pathname),window.location.href="/login"},set_cart_count:function(){var t=frappe.get_cookie("cart_count");"Guest"===frappe.session.user&&(t=0),t&&$(".shopping-cart").toggleClass("hidden",!1);var e=$(".cart-icon"),a=e.find("#cart-count");0===parseInt(t)||void 0===t?(e.css("display","none"),$(".cart-items").html("Cart is Empty"),$(".cart-tax-items").hide(),$(".btn-place-order").hide(),$(".cart-addresses").hide()):e.css("display","inline"),t?a.html(t):a.remove()},shopping_cart_update:function(e){var a=e.item_code,n=e.qty,r=e.cart_dropdown,s=e.additional_notes;frappe.freeze(),t.update_cart({item_code:a,qty:n,additional_notes:s,with_items:1,btn:this,callback:function(t){frappe.unfreeze(),t.exc||($(".cart-items").html(t.message.items),$(".cart-tax-items").html(t.message.taxes),1!=r&&$(".cart-icon").hide())}})},bind_dropdown_cart_buttons:function(){$(".cart-icon").on("click",".number-spinner button",function(){var e=$(this),a=e.closest(".number-spinner").find("input"),n=a.val().trim(),r=0;"up"==e.attr("data-dir")?r=parseInt(n)+1:n>1&&(r=parseInt(n)-1),a.val(r);var s=a.attr("data-item-code");return t.shopping_cart_update({item_code:s,qty:r,cart_dropdown:!0}),!1})}})}();
//# sourceMappingURL=erpnext-web.min.js.map
